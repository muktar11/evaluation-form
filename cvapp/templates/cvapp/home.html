{% extends 'cvapp/base.html' %}
{% block content %}

<h2 class="mb-3">ðŸ“‹ Recent Submissions</h2>

<div class="table-responsive">
  <table class="table table-bordered table-hover align-middle">
    <thead class="table-primary text-center">
      <tr>
        <th>Name</th>
        <th>Phone</th>
        <th>Passport</th>
        <th>Age</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for s in submissions %}
      <tr>
        <td>{{ s.name }}</td>
        <td>{{ s.phone }}</td>
        <td>{{ s.passport_number|default:"â€”" }}</td>
        <td>{{ s.age|default:"â€”" }}</td>
        <td>
          {% if s.booked %}
          <span class="badge bg-success">Booked</span><br>
          <small>{{ s.booked_by_name }}</small>
          {% else %}
          <span class="badge bg-secondary">Available</span>
          {% endif %}
        </td>
        <td class="text-center">
          <a href="{% url 'cvapp:submission_detail' s.id %}" class="btn btn-sm btn-primary">View</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center text-muted">No submissions yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- ðŸ§­ Notification Modal -->
<div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="notificationModalLabel">ðŸ“¢ Booking Notifications</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        {% if notifications %}
        <ul class="list-group">
          {% for n in notifications %}
          <li class="list-group-item">
            <strong>{{ n.submission.name }}</strong> booked by <strong>{{ n.booker_name }}</strong>
            (<span class="text-muted">{{ n.booker_phone }}</span>)<br>
            <small class="text-muted">ðŸ“… {{ n.created_at|date:"Y-m-d H:i" }}</small>
          </li>
          {% endfor %}
        </ul>

        <!-- Pagination -->
        <nav class="mt-3">
          <ul class="pagination justify-content-center">
            {% if notifications.has_previous %}
            <li class="page-item"><a class="page-link" href="?page={{ notifications.previous_page_number }}">Previous</a></li>
            {% endif %}
            <li class="page-item disabled"><span class="page-link">Page {{ notifications.number }} of {{ notifications.paginator.num_pages }}</span></li>
            {% if notifications.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ notifications.next_page_number }}">Next</a></li>
            {% endif %}
          </ul>
        </nav>

        {% else %}
        <div class="alert alert-info">No bookings yet.</div>
        {% endif %}
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}
